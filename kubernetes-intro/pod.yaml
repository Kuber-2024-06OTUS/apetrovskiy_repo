apiVersion: v1
kind: Pod
metadata:
  name: intro
  namespace: homework
spec:
  os: {name: linux}
  serviceAccountName: homework
  automountServiceAccountToken: false
  restartPolicy: Never
  containers:
    - name: web
      image: nginx:alpine
      ports:
        - containerPort: 8000
          hostPort: 8000
          name: web-port
      volumeMounts:
        - name: webvolume
          mountPath: /homework
      lifecycle:
        preStop:
          exec:
            command:
              - "rm -f /homework/index.html"

  initContainers:
    - name: init-web
      image: busybox:stable
      # image: busybox:latest
      command: ["sh", "-c"]
      args:
        - "echo 'Hello World!' > /init/index.html"
      # command:
      #   - ls /
        # - mkdir -p /init
        # - wget -k -P /init/index.html http://yandex.ru/
      volumeMounts:
        - name: webvolume
          mountPath: /init

  volumes:
    - name: webvolume
      emptyDir: {}
